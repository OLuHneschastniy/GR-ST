<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Starosta Kit</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
/* === VARIABLES === */
:root {
    --bg-color: #0f172a;
    --glass-bg: rgba(30, 41, 59, 0.75);
    --glass-border: rgba(255, 255, 255, 0.08);
    --text-main: #f8fafc;
    --text-muted: #94a3b8;
    --primary: #3b82f6;
    --primary-glow: rgba(59, 130, 246, 0.5);
    --accent: #8b5cf6;
    --accent-glow: rgba(139, 92, 246, 0.5);
    --input-bg: rgba(15, 23, 42, 0.6);
    --radius: 24px;
    --input-height: 54px;
    --anim-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
    --anim-smooth: cubic-bezier(0.4, 0, 0.2, 1);
}

body.light-mode {
    --bg-color: #f8fafc;
    --glass-bg: rgba(255, 255, 255, 0.8);
    --glass-border: rgba(0, 0, 0, 0.05);
    --text-main: #0f172a;
    --text-muted: #64748b;
    --primary: #2563eb;
    --input-bg: rgba(255, 255, 255, 0.6);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-color);
    color: var(--text-main);
    margin: 0; padding: 20px;
    min-height: 100vh;
    transition: background-color 0.5s ease;
    overflow-x: hidden;
}

/* === BACKGROUND === */
.aurora-bg {
    position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
    overflow: hidden; pointer-events: none;
}
.blob {
    position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.35;
    animation: float 12s infinite ease-in-out;
}
.blob-1 { top: -10%; left: -10%; width: 50vh; height: 50vh; background: var(--primary); }
.blob-2 { bottom: -10%; right: -10%; width: 60vh; height: 60vh; background: var(--accent); animation-delay: -6s; }
@keyframes float { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(30px, 40px); } }

.container {
    max-width: 480px; margin: 0 auto;
    display: flex; flex-direction: column; min-height: 90vh; justify-content: center;
}

/* === GLASS CARD === */
.glass-card {
    background: var(--glass-bg);
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    padding: 24px; margin-bottom: 20px;
    box-shadow: 0 20px 40px -10px rgba(0,0,0,0.3);
}

/* === LOGIN SCREEN === */
.login-header { text-align: center; margin-bottom: 30px; animation: fadeIn 0.8s ease; }
.login-header h1 { margin: 10px 0 5px; font-size: 28px; font-weight: 800; letter-spacing: -0.5px; }
.login-header p { margin: 0; color: var(--text-muted); font-size: 14px; }

.section-label {
    font-size: 12px; font-weight: 700; color: var(--primary);
    text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;
}

/* DEPT BUTTONS */
.dept-grid {
    display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 0;
}
.dept-btn {
    padding: 18px 0; border: 2px solid var(--glass-border); border-radius: 16px;
    background: var(--input-bg); color: var(--text-main); font-weight: 700; font-size: 15px;
    cursor: pointer; transition: all 0.3s var(--anim-spring);
}
.dept-btn:hover { transform: translateY(-2px); border-color: var(--primary); }
.dept-btn:active { transform: scale(0.95); }
.dept-btn.active {
    background: var(--primary); color: white; border-color: var(--primary);
    box-shadow: 0 8px 20px var(--primary-glow);
}

/* ANIMATIONS */
.anim-wrapper {
    display: grid; grid-template-rows: 0fr; opacity: 0;
    transition: grid-template-rows 0.5s var(--anim-smooth), opacity 0.5s ease, margin 0.5s ease;
    margin-top: 0;
}
.anim-wrapper.open { grid-template-rows: 1fr; opacity: 1; margin-top: 24px; }
.anim-inner { overflow: hidden; }

/* INPUTS & SELECTS */
.pixel-select, .pixel-input {
    width: 100%; height: var(--input-height);
    background: var(--input-bg); border: 2px solid var(--glass-border);
    border-radius: 16px; color: var(--text-main); font-size: 16px; font-weight: 500;
    padding: 0 16px; outline: none; appearance: none;
    transition: 0.3s;
}
.pixel-select {
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat; background-position: right 16px center;
}
.pixel-input:focus, .pixel-select:focus { border-color: var(--primary); box-shadow: 0 0 0 4px var(--primary-glow); }

/* NEW: BUTTON INSIDE INPUT */
.input-wrapper { position: relative; width: 100%; }
.input-icon-btn {
    position: absolute; right: 8px; top: 50%; transform: translateY(-50%);
    background: var(--primary); border: none; border-radius: 10px;
    width: 32px; height: 32px; color: white; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.input-icon-btn:hover { transform: translateY(-50%) scale(1.1); }
.input-icon-btn:active { transform: translateY(-50%) scale(0.95); }

/* DATE GRID */
.date-grid {
    display: grid; grid-template-columns: 0.8fr 2fr 1fr; gap: 10px;
}

/* START BUTTON & BOTTOM ACTIONS */
.btn-wrapper {
    display: grid; grid-template-rows: 0fr; opacity: 0;
    transition: grid-template-rows 0.5s var(--anim-smooth), opacity 0.5s ease, margin 0.5s ease;
}
.btn-wrapper.visible { grid-template-rows: 1fr; opacity: 1; margin-top: 24px; }

.actions-bar {
    position: fixed; bottom: 20px; left: 20px; right: 20px; z-index: 50;
    display: flex; gap: 10px; max-width: 480px; margin: 0 auto;
}

.start-btn {
    width: 100%; height: 60px;
    background: linear-gradient(135deg, var(--primary), var(--primary-glow));
    border: none; border-radius: 18px;
    color: white; font-size: 16px; font-weight: 700;
    display: flex; align-items: center; justify-content: center; gap: 10px;
    cursor: pointer; box-shadow: 0 10px 25px var(--primary-glow);
    transition: transform 0.2s; flex: 1;
}
.start-btn.secondary {
    background: linear-gradient(135deg, var(--accent), #7c3aed);
    box-shadow: 0 10px 25px var(--accent-glow);
}
.start-btn:active { transform: scale(0.97); }

/* APP SCREEN */
.app-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.schedule-item { margin-bottom: 16px; border-bottom: 1px solid var(--glass-border); padding-bottom: 16px; }
.student-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--glass-border); }
.item-label { font-size: 11px; color: var(--primary); font-weight: 800; margin-bottom: 8px; display: block; }

/* UTILS */
.hidden { display: none !important; }
.fade-in { animation: fadeIn 0.6s ease backwards; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.toast {
    position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%) translateY(20px);
    background: rgba(15, 23, 42, 0.95); color: white; padding: 12px 24px; border-radius: 50px;
    font-size: 14px; opacity: 0; transition: 0.3s; z-index: 100; border: 1px solid var(--glass-border);
}
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* SWITCH */
.switch { position: relative; width: 46px; height: 24px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: var(--input-bg); border-radius: 34px; transition: .3s; }
.slider:before { content: ""; position: absolute; height: 18px; width: 18px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: .3s; }
input:checked + .slider { background: var(--primary); }
input:checked + .slider:before { transform: translateX(22px); }

/* DETAILS */
.student-details { height: 0; overflow: hidden; transition: height 0.3s ease; background: rgba(0,0,0,0.1); border-radius: 12px; margin-top: 4px; }
.details-content { padding: 12px; }
.chips { display: flex; gap: 5px; margin-top: 10px; }
.chip-lbl { flex: 1; }
.chip-div { height: 40px; display: flex; align-items: center; justify-content: center; background: var(--input-bg); border-radius: 8px; font-weight: 600; border: 1px solid transparent; transition: 0.2s; }
.chip-lbl input:checked + .chip-div { background: var(--primary); color: white; border-color: var(--primary); }

</style>
</head>
<body>

<div class="aurora-bg">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
</div>

<div id="toast" class="toast">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</div>

<div class="container">

    <div id="loginScreen">
        
        <div class="login-header">
            <span class="material-icons-round" style="font-size: 60px; color: var(--primary); filter: drop-shadow(0 0 15px var(--primary-glow));">school</span>
            <h1>QuickRaport</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ä–∞–ø–æ—Ä—Ç–∏—á–æ–∫</p>
        </div>

        <div class="glass-card fade-in">
            
            <div class="section-label">–û–±–µ—Ä—ñ—Ç—å –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è</div>
            <div class="dept-grid">
                <button class="dept-btn" onclick="selectDept('KI', this)">–ö–Ü</button>
                <button class="dept-btn" onclick="selectDept('RZ', this)">–†–ó</button>
                <button class="dept-btn" onclick="selectDept('–Ü–¢', this)">–Ü–¢</button>
            </div>

            <div id="groupAnimWrapper" class="anim-wrapper">
                <div class="anim-inner">
                    <div class="section-label" style="margin-top: 10px;">–û–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É</div>
                    <select id="groupSelect" class="pixel-select" onchange="checkGroup()">
                        <option value="" disabled selected>‚Äî –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø ‚Äî</option>
                    </select>
                </div>
            </div>

            <div id="btnAnimWrapper" class="btn-wrapper">
                <div class="anim-inner">
                    <button class="start-btn" onclick="enterApp()">
                        –ü–æ—á–∞—Ç–∏ <span class="material-icons-round">arrow_forward</span>
                    </button>
                </div>
            </div>

        </div>
    </div>

    <div id="appScreen" class="hidden fade-in">
        <div class="app-header">
            <div>
                <h2 id="headerTitle" style="margin:0; font-size:22px;">–ì—Ä—É–ø–∞</h2>
                <div id="headerSubtitle" style="font-size:13px; color:var(--text-muted);">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</div>
            </div>
            <button onclick="toggleTheme()" style="background:none; border:none; color:var(--text-main); cursor:pointer;">
                <span class="material-icons-round" id="themeIcon" style="font-size:28px;">light_mode</span>
            </button>
        </div>

        <div class="glass-card">
            <div class="section-label"><span class="material-icons-round" style="font-size:14px; vertical-align:middle;">tune</span> –î–∞—Ç–∞ —Ç–∞ –†–µ–∂–∏–º</div>
            <div class="date-grid">
                <input type="number" id="dayInput" class="pixel-input" placeholder="–î–î">
                <select id="monthInput" class="pixel-select" style="text-align:left;">
                    <option value="0">–°—ñ—á–µ–Ω—å</option><option value="1">–õ—é—Ç–∏–π</option>
                    <option value="2">–ë–µ—Ä–µ–∑–µ–Ω—å</option><option value="3">–ö–≤—ñ—Ç–µ–Ω—å</option>
                    <option value="4">–¢—Ä–∞–≤–µ–Ω—å</option><option value="5">–ß–µ—Ä–≤–µ–Ω—å</option>
                    <option value="6">–õ–∏–ø–µ–Ω—å</option><option value="7">–°–µ—Ä–ø–µ–Ω—å</option>
                    <option value="8">–í–µ—Ä–µ—Å–µ–Ω—å</option><option value="9">–ñ–æ–≤—Ç–µ–Ω—å</option>
                    <option value="10">–õ–∏—Å—Ç–æ–ø–∞–¥</option><option value="11">–ì—Ä—É–¥–µ–Ω—å</option>
                </select>
                <input type="number" id="yearInput" class="pixel-input" placeholder="–†–†–†–†">
            </div>

            <div style="margin-top:15px;">
                <input type="file" id="fileUpload" accept=".xlsx" style="display:none" onchange="handleFileUpload(this)">
                
                <button class="dept-btn" style="width:100%; display:flex; align-items:center; justify-content:center; gap:10px;" 
                        id="uploadBtn" onclick="document.getElementById('fileUpload').click()">
                    <span class="material-icons-round">upload_file</span>
                    <span id="uploadBtnText">–ú–∞—é —Ñ–∞–π–ª (–ó–∞–ø–æ–≤–Ω–∏—Ç–∏ –ü—Ä–∞–≤—É)</span>
                </button>

                <div id="fileStatus" style="text-align:center; font-size:12px; color:var(--text-muted); margin-top:8px;">
                    –†–µ–∂–∏–º: <b>–ù–æ–≤–∏–π —Ñ–∞–π–ª (–õ—ñ–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞)</b>
                </div>
            </div>
            <input type="hidden" id="sideVal" value="left">
        </div>

        <div class="glass-card">
            <div class="section-label"><span class="material-icons-round" style="font-size:14px; vertical-align:middle;">schedule</span> –†–æ–∑–∫–ª–∞–¥</div>
            <div id="scheduleContainer"></div>
        </div>

        <div class="glass-card" style="padding-bottom:100px;">
            <div class="section-label"><span class="material-icons-round" style="font-size:14px; vertical-align:middle;">people</span> –°—Ç—É–¥–µ–Ω—Ç–∏</div>
            <div id="studentsContainer"></div>
        </div>

        <div class="actions-bar">
            <button class="start-btn" onclick="generateExcel()">
                <span class="material-icons-round">download</span> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏
            </button>
            <button class="start-btn secondary" onclick="sendToDept()">
                <span class="material-icons-round">send</span> –ù–∞–¥—ñ—Å–ª–∞—Ç–∏
            </button>
        </div>
    </div>

</div>

<script>
// === EMAILS CONFIG ===
const deptEmails = {
    "KI": "email_ki@example.com", 
    "RZ": "email_rz@example.com",
    "–Ü–¢": "email_rt@example.com"
};

// –í–ê–® –®–ê–ë–õ–û–ù (–ù–ï –ó–ê–ë–£–î–¨ –í–°–¢–ê–í–ò–¢–ò –ô–û–ì–û –°–Æ–î–ò –ó–ù–û–í–£)
const templateBase64 = ""; 

const groupsDB = {
    "KI": {
        "91": { name: "–ì—Ä—É–ø–∞ 91 (–ö–Ü)", startYear: 2025, students: ["–ê–Ω—ñ—â–µ–Ω–∫–æ –û.–ú.", "–ë–∞—Ä–∞—É—Å–æ–≤ –î.–û.", "–ë–∞—Ç–æ—Ä–∏–∫ –ê.–ê.", "–ì–∞–ª–µ—Ü—å–∫–∏–π –í.–ê.", "–ì—Ä–∏–¥–Ω—å–æ–≤ –ú.–ê.", "–î–µ–º—á–µ–Ω–∫–æ –û.–í.", "–î–æ–ª–∂–µ–Ω–∫–æ –î.–°.", "–ö–∞–ø–ª—è –ö.–û.", "–ö—Ä–∞–≤—á–µ–Ω–∫–æ –û.–ü.", "–ö—É—Ä–≥–∞–Ω—Å—å–∫–∏–π –ê.–û.", "–õ–∞–Ω–Ω–∏–π –ê.–í.", "–ú–∞–π–æ—Ä –ê.–†.", "–ú–∞–∫—Å–∏–º–µ–Ω–∫–æ –î.–û.", "–ú–æ–≥–∏–ª–∫–∞ –ú.–î.", "–ú–æ—Ä—É—Å –ê.–ê.", "–ù—ñ–∫—É–ª—å—à–∏–Ω–∞ –ü.–û.", "–ù–æ—Å—É–ª—è –û.–ì.", "–û–ª–µ—â–µ–Ω–∫–æ –†.–ê.", "–û—Ä–µ—à–∫–∏–Ω –ê.–í.", "–°–≤—î–∂–µ–Ω—Ü–µ–≤–∞ –í.–ú.", "–°–æ–ª–æ–≤–π–æ–≤ –ì.–í.", "–°—Ç—Ä—É–Ω—ñ–Ω –ï.–ú.", "–¢—é–∫–æ–≤–∞ –ù.–°.", "–®—Ä–∞–º–∫–æ –ê.–Ü."] },
        "90": { name: "–ì—Ä—É–ø–∞ 90 (–ö–Ü)", startYear: 2025, students: ["–ë–µ—Ä–º–µ—Å –û.–í.", "–ë–æ–≥–¥–∞–Ω –ê.–ê.", "–ë—É–∫—Ä—î—î–≤ –ü.–Æ.", "–ì—Ä–∏—à–µ–Ω–∫–æ –Ø.–ê.", "–î—É–¥–∞—Ä—î–≤ –¢.–Ü.", "–Ñ–ª—ñ–Ω –ú.–°.", "–ó–µ–ª–µ—Ü—å–∫–∏–π –î.–†.", "–ó–∏–º–∞ –ú.–í.", "–Ü–≤–∞–Ω–æ–≤ –ù.–ú.", "–ö–∞–ª–∞–Ω—Ç–∞—î–≤—Å—å–∫–∏–π –í.–í.", "–ö–∞–º–∏—à–∞–Ω—Å—å–∫–∏–π –ö.–°.", "–ö–∞–Ω—ñ–≤–µ—Ü—å –ú.–î.", "–ö—Ä–∞—Å—ñ–ª—å–Ω–∞ –°.–°.", "–ú–∞–∑—É—Ä–∫–µ–≤–∏—á –Ü.–Ü.", "–ú–æ—Å—å–ø–∞–Ω –¢.–°.", "–ù–æ—Å–µ–Ω–∫–æ –ù.–°.", "–û—Å—Ç–∞–ø–µ–Ω–∫–æ –ê.–î.", "–ü–ª—ñ—Ç–∫–∞ –î.–°.", "–ü–æ–∫—É–ª–∏—Ç–∞ –ö.–ê.", "–†–æ–º–∞–Ω–æ–≤ –î.–ú.", "–°–∞–º–æ–π–ª–æ–≤–∏—á –ö.–Æ.", "–°–∞—Ö–∞—Ä–æ–≤ –†.–î.", "–°—Ç–∞—Ä–∏–Ω–∞ –î.–Ñ.", "–ß—É–º–∞–∫–æ–≤ –î.–°.", "–®–∞–º—Ä–∞–π –í.–û."] },
        "86": { name: "–ì—Ä—É–ø–∞ 86 (–ö–Ü)", startYear: 2024, students: ["–ê–≤–µ—Ä—á–µ–Ω–∫–æ–≤–∞ –°.–°.","–ê–Ω—ñ—â–µ–Ω–∫–æ –Ñ.–ú.","–ë—ñ–ª–∏–∫ –ê.–î.","–ë–æ–≥–¥–∞–Ω–æ–≤ –ú.–û.","–ì–æ–Ω—è—î–≤ –Ø.–ö.","–ì–æ—Ä–µ–ª–æ–≤ –Ø.–ê.","–ì—Ä–µ–∫ –ú.–í.","–î–º–∏—Ç—Ä—ñ—î–≤ –ì.–û.","–î–æ–≤–≥–∞–Ω–µ–Ω–∫–æ –í.–û.","–ñ–∏–≥–∞–π –ú.–î.","–ö–∞–ª—é–∂–Ω–∞ –ü.–î.","–ö–∞—Ä–ø—É—Å–µ–Ω–∫–æ –ù.–ê.","–ö—ñ–±–µ–Ω–∫–æ –ú.–†.","–ö–æ—Ä–Ω—î–≤ –î.–û.","–ö—Ä–∏–∫–æ–≤–ª—é–∫ –ö.–°.","–ú–∞—Ö–æ–Ω—è –Ñ.–î.","–ù–µ—á–∏–ø–æ—Ä–µ–Ω–∫–æ –Ü.–Æ.","–ù—ñ–º—á–µ–Ω–∫–æ –ë.–°.","–û–º–µ–ª—å—á–µ–Ω–∫–æ –†.–í.","–ü—ñ–ª—å–≥—É–π –ö.–ú.","–ü–æ–∑–∏–≤–∞–π –Ñ.–Ñ.","–†—É–¥–µ–Ω–∫–æ –ì.–í.","–¶–∏–≥–∞–Ω–∫–æ–≤ –í.–ì.","–ß–æ—Ä–Ω–∏–π –ù.–Æ.","–©–µ—Ä–±–∞–Ω—å –ö.–î."] },
        "85": { name: "–ì—Ä—É–ø–∞ 85 (–ö–Ü)", startYear: 2024, students: ["–ë—ñ–ª–µ–π –ú.–î.","–ë–æ–Ω–¥–∞—Ä–µ—Ü—å –ú.–†.","–ì–∞—Ä–∫—É—à–∞ –†.–°.","–î–µ–º—á–µ–Ω–∫–æ –í.–ê.","–Ñ–≤—Å—Ç—Ä–∞—Ç–µ–Ω–∫–æ –Ü.–í.","–ó–∞–π—á–µ–Ω–∫–æ –Ø.–ü.","–ö–∏—Ä–ø–∞ –ì.–°.","–ö–ª–∏–º–µ–Ω–∫–æ –°.–û.","–ö–æ–ª–µ—Å–æ–≤ –ú.–í.","–ö–æ–ª—ñ—Å–Ω—ñ—á–µ–Ω–∫–æ –Ü.–ë.","–ö—Ä–∏–≤–µ–Ω–∫–æ –ú.–û.","–õ–µ–¥–Ω—å–æ–≤ –Ñ.–û.","–ú–∞—Å–∞–ª–æ–≤–∞ –í.–ú.","–ú—É—Ä–∑—ñ–Ω –¢.–ë.","–ù–µ—Ç—É–¥–∏—Ö–∞—Ç–∞ –ë.–°.","–ü–∏—Å—å–º–µ–Ω–Ω–∏–π –¢.–†.","–ü—ñ–Ω—å–∫–æ–≤—Å—å–∫–∏–π –ê.–†.","–°–∞–º–∞—Ä–µ—Ü—å –Ü.–î.","–°–∏–¥–æ—Ä–µ–Ω–∫–æ –û.–°.","–°–∫–ª—è—Ä–µ–Ω–∫–æ –†.–Ü.","–¢–∫–∞—á–µ–Ω–∫–æ –í.–ú.","–¢—Ä–µ—Ç—è–∫ –ì.–ü.","–®–µ—Ä–µ–º–µ—Ç –î.–°.","–®–∫—É—Ä–µ–Ω–∫–æ –ü.–ö.","–®—É–ª—å–≥–∞ –û.–ì."] },
        "80": { name: "–ì—Ä—É–ø–∞ 80 (–ö–Ü)", startYear: 2023, students: ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤ –Ü.–ü.","–ë—ñ–ª—è–≤—Å—å–∫–∏–π –ï.–í.","–í–µ–¥–º–µ–¥–µ–Ω–∫–æ –ú.–í.","–ì–æ–ª–æ—Ñ—ñ—î–≤—Å—å–∫–∏–π –í.–ê.","–ì—Ä–∏–±–µ–Ω–∫–∞ –ö.–Ü.","–î–∞–Ω–∏–ª–æ–≤ –ê.–°.","–î–µ–Ω–∏—Å–µ–Ω–∫–æ –û.–Ñ.","–î–æ—Ä–æ—à–µ–Ω–∫–æ –î.–°.","–î—Ä–∏–∫—ñ–Ω –î.–í.","–î—è—á–µ–Ω–∫–æ –ú.–û.","–ñ–∏–≥–∞–ª–∫—ñ–Ω –Ñ.–ê.","–ó—î–ª—î–Ω—ñ–Ω –ê.–í.","–ó–µ–Ω—á–µ–Ω–∫–æ –ê.–û.","–ö–æ—Ä—Å—É–Ω –ú.–û.","–ö—É–∑—å–º–µ–Ω–∫–æ –ë.–°.","–õ—ñ–Ω—Å—å–∫–∏–π –í.–î.","–õ—É–∫‚Äô—è–Ω–µ–Ω–∫–æ –°.–û.","–ù–µ—á—Ç–∞ –ù.–û.","–ü—É–≥–∞—á–æ–≤ –î.–Ü.","–†—ñ–∑–Ω–∏—á–µ–Ω–∫–æ –í.–Ñ.","–†–æ–º–∞—â–µ–Ω–∫–æ –ê.–í.","–°–≤–∏—Ç–∞ –î.–°.","–°–µ–º–∏—Å–∞–ª –ì.–û.","–°—Ç—Ä–µ–ª—å—Ü–æ–≤ –í.–í.","–ß–∏—Ä–≤–∞ –í.–Ü."] },
        "79": { name: "–ì—Ä—É–ø–∞ 79 (–ö–Ü)", startYear: 2023, students: ["–ê–π–≤–∞–∑—è–Ω –î.–ê.","–ë–∞–ª—é—Ä–∞ –Ü.–°.","–ë–∞–ª—é—Ä–∞ –ö.–°.","–í–∞—Ö–Ω–æ –î.–û.","–î—è—á–µ–Ω–∫–æ –Ü.–°.","–ó–∞—â–æ–ª–∫—ñ–Ω –†.–û.","–ö–∏—Ä–ø–∞ –†.–†.","–ö–æ–ø–∞—á–æ–≤–∞ –ê.–ï.","–ö—É–∑–µ–≤–∞–Ω–æ–≤ –ö.–ü.","–ú–∏—Ä–æ—à–Ω–∏–∫ –Ü.–ê.","–ú—ñ—Ö–∞–ª—å–æ–≤ –î.–í.","–ù–æ—Å–∫–æ –ú.–ú.","–ù–æ—Å–∫–æ –¢.–ú.","–û–ª—ñ–π–Ω–∏–∫ –ê.–û.","–†—É–¥—Å—å–∫–∏–π –†.–í.","–°–∞—Ä–¥–∞–Ω–æ–≤ –ê.–Æ.","–°—î–º—î–π–∫–æ –Ñ.–ú.","–°—ñ–ø–∞–∫–æ–≤ –ú.–î.","–°–∫—Ä–∏—Ü—å–∫–∏–π –í.–û.","–°–æ—Ä–æ–∫–æ–ø—É–¥ –í.–û.","–°–æ—Å–Ω—ñ—Ü—å–∫–∏–π –ê.–°.","–¢–∏—Ö–æ–Ω–µ–Ω–∫–æ –Ø.–Æ.","–§–µ–æ–∫—Ç—ñ—Å—Ç–æ–≤ –Ü.–î.","–®–µ–≤—á–µ–Ω–∫–æ –°.–í.","–®–µ—Ä–µ–º–µ—Ç—å—î–≤ –ú.–û."] } },
    "RZ": {
    },
    "–Ü–¢": {
        "87": { name: "–ì—Ä—É–ø–∞ 87 (–Ü–¢)", startYear: 2025, students: ["–ë—ñ–ª–æ–∫–æ–ø–∏—Ç–æ–≤ –û.–°.","–ë–æ–Ω–¥—é–∫ –ú.–°.","–ë—Ä–∏–∫–∞–ª—ñ–Ω –û.–°.","–ë—Ä–∏–Ω–¥—ñ–Ω –û.–û.","–ì–ª–∞–∑–∏—á–µ–≤–∞ –ì.–í.","–ì–æ—Ä–±–µ–Ω–∫–æ –û.–°.","–î–∏–Ω–∏—Å—é–∫ –ú.–ú.","–î–æ–≥–æ–Ω–æ–≤ –î.–í.","–î–æ–≥–æ–Ω–æ–≤ –Ü.–í.","–Ñ–≥–æ—Ä–æ–≤ –¢.–î.","–ö–∞—Ä–ø—ñ–∫–æ–≤ –ê.–ê.","–ö–æ–≤–∞–ª–¥—ñ–Ω –î.–û.","–ú–∏—Ä–æ—à–Ω–∏—á–µ–Ω–∫–æ –Ñ.–°.","–ú—ñ–Ω—è–π–ª–æ –ë.–†.","–ú–æ—Å–∫–∞–ª–µ–Ω–∫–æ –í.–ü.","–ù–æ–≤–∞–∫ –ú.–í.","–ü–∞–≤–ª—é–∫ –ü.–û.","–ü–∞—Å–∫–∞–ª–æ–≤ –î.–û.","–ü–µ—Ä–µ—Å—É–Ω—å–∫–æ –ê.–û.","–ü–µ—Ç—Ä–µ–Ω–∫–æ –ü.–ö.","–ü–æ–¥–æ–±—î–¥–æ–≤ –ê.–ö.","–ü–æ—Ä—Ö—É–Ω –û.–ê.","–°–∞–º–æ–π–ª–µ–Ω–∫–æ –í.–Ü.","–¢–∞—Ä–∞–Ω –ú.–°.","–¢–µ—Ä—Ç–∏—à–Ω–∏–∫ –û.–û.","–¢–∏–º–æ—à–µ–Ω–∫–æ –û.–ê.","–¢–æ—Ä—è–Ω—Å—å–∫–∏–π –ú.–°.","–®–µ–≤—Ü–æ–≤ –î.–í."] },
        "82": { name: "–ì—Ä—É–ø–∞ 82 (–Ü–¢)", startYear: 2024, students: ["–ë—ñ–ª–∏–∫ –ê.–ê.","–ë—É–¥–Ω–∏–∫ –ë.–û.","–î—É–¥–∫—ñ–Ω –ú.–°.","–Ñ–≤–¥–æ—à–µ–Ω–∫–æ –ú.–û.","–Ñ—Ä—à–æ–≤ –õ.–ú.","–ñ—É—Ä—ñ–∫–æ–≤ –ú.–°.","–ö–∞—Ä–ø–æ–≤–µ—Ü—å –Ü.–ê.","–ö–æ–∑–∞—Ä –†.–ì.","–ö–æ–ª–æ–º–æ—î—Ü—å –ù.–û.","–ö–æ—Ä–æ—Ç–∞—î–≤ –õ.–í.","–ö–æ—Å—è—á–µ–Ω–∫–æ –ê.–í.","–õ—î–º—è–≥–æ–≤ –î.–ú.","–õ–∏—Å–∏—á–Ω–∏–π –í.–ê.","–õ–∏—Ç–≤–∏–Ω –î.–Ü.","–õ—É–∫‚Äô—è–Ω–µ–Ω–∫–æ –í.–ú.","–ú–∞—Ä—Ç–∏–Ω–æ–≤ –Ü.–û.","–ú–∏—Å–∏–∫ –í.–ê.","–ù–æ–≤–æ—Å—å–æ–ª–æ–≤–∞ –í.–ê.","–ü–∞—Ä—É—à–∫—ñ–Ω –î.–û.","–ü–µ—Ç—Ä—É–∫ –ö.–ì.","–°–µ–º–µ–Ω–µ—Ü—å –†.–ê.","–°—É—à–∫–æ –ú.–ú.","–¢–µ—Ä–µ—â–µ–Ω–∫–æ –ú.–ê.","–¶–∏—Ä—É–ª–∏–∫ –ê.–°.","–®–µ—Ä–µ–º—î—Ç–æ–≤ –ú.–Ü.","–Æ—Ä—á—É–∫ –ë.–ú.","–Ø–∫—É–±–µ–Ω–∫–æ –î.–ê."] },
        "81": { name: "–ì—Ä—É–ø–∞ 81 (–Ü–¢)", startYear: 2024, students: ["–ë–æ–π–∫–æ –ú.–í.","–ì–∞–ø–æ—á–µ–Ω–∫–æ –Ü.–ê.","–ì–æ–ª–æ–≤—ñ–Ω –ê.–û.","–ó–∞–≥–æ—Ä–æ–¥–Ω—ñ–π –ú.–í.","–ó–∞–æ–∑—ñ—Ä–Ω–∏–π –Ü.–ê.","–Ü–≤–∞—â–µ–Ω–∫–æ –ö.–û.","–Ü–ª–ª–µ–Ω–∑–µ—î—Ä –î.–û.","–ö–∞—Ä–∞—Å—î–≤–∏—á –ú.–û.","–ö–æ–≤–∞–ª–µ–Ω–∫–æ –ì.–û.","–ö–æ–≤–∞–ª—å—á—É–∫ –ú.–°.","–ö–æ—Ä–¥—ñ–Ω –Ü.–û.","–ú–∞—Ä—Ç–∏–Ω–µ–Ω–∫–æ –Ñ.–†.","–ú–∞—Ç–≤—ñ—î–Ω–∫–æ –Ü.–û.","–ú–æ—Ç–∞ –ù.–ê.","–ü–∞–Ω–∫–æ–≤ –†.–î.","–ü–∏–ª–∏–ø–µ–Ω–∫–æ –õ.–ú.","–°–∞–≤–µ–Ω–∫–æ –í.–ê.","–°–∏–≤–∞—à –¢.–¢.","–°—ñ—Ä–∏–π –î.–°.","–°–æ–ª–æ—â–µ–Ω–∫–æ –ì.–û.","–°–æ–ª—Ç–∞–Ω-–®–≤–∞—Ä—Ü –í.–û.","–¢–∞—Ä–∞—Å—é–∫ –í.–î.","–¢–∞—Ü—É–ª—è –î.–û.","–•–æ–¥–æ—Å –î.–û.","–®–≤–∞–≥–µ—Ä –Ñ.–ú.","–®–ø–∞–∫ –ú.–û.","–Ø—Ü–µ–Ω–∫–æ –ê.–†."] },
        "76": { name: "–ì—Ä—É–ø–∞ 76 (–Ü–¢)", startYear: 2023, students: ["–ë–∞—Å–∞–ª–∞—î–≤ –î.–í.","–í–∞–ª–µ–Ω—Ç—ñ—Ä–æ–≤ –ê.–û.","–ì–ª–∞–¥–∫–∏–π –Ñ.–†.","–ì—Ä–µ–±–µ–Ω—é–∫ –ù.–ü.","–î–∏–º–∞—Ä—å–æ–≤ –ö.–û.","–Ñ—Ñ—ñ–º–æ–≤ –û.–ö.","–ö–∞–≥–∞–ª–∞ –Ü.–ê.","–ö–æ–Ω–æ–Ω–µ–Ω–∫–æ –†.–Æ.","–ö–æ—Ä–æ–ª—å–∫–æ–≤ –ë.–û.","–ö–æ—Å—Ç—é—á–µ–Ω–∫–æ –û.–°.","–ö—É–¥—ñ–Ω –ú.–û.","–ö—É–∑–Ω–µ—Ü–æ–≤ –í.–Ü.","–õ–∞—Å—Ç–æ–≤—ñ–Ω –ú.–í.","–õ–∏—Å—Ç–æ–ø–∞–¥ –ù.–í.","–ú–∞–ª—å–æ–≤–∞–Ω–∏–π –ú.–í.","–ú–∞—Ä—ñ–Ω—ñ—á –ê.–Ü.","–û–ª–µ—Ñ—ñ—Ä–æ–≤ –Ø.–î.","–û—Ç—ñ–Ω–æ–≤ –ú.–î.","–ü–∞–Ω–∫—Ä–∞—Ç–æ–≤ –î.–ú.","–°—ñ–≤—Ü–æ–≤ –ú.–û.","–°–∫–æ—Ä–æ–±–æ–≥–∞—Ç—å–∫–æ –ú.–î.","–°–º–æ–ª—å—è–Ω—ñ–Ω –ú.–°.","–°—Ç—Ä–∏–∂–∫–æ –ú.–°.","–¢—Ä–æ—Ñ–∏–º–æ–≤ –û.–ö.","–®–∞–∫–ª—ñ–Ω –û.–û.","–®–ø–∞–∫ –î.–ï."] },
        "75": { name: "–ì—Ä—É–ø–∞ 75 (–Ü–¢)", startYear: 2023, students: ["–ë—É—Ä–ª–∞–∫–æ–≤ –ë.–í.","–ì–æ–¥—É–Ω–æ–≤ –î.–û.","–î–æ–ª–≥–æ–≤ –Ü.–û.","–î–æ—Ü–µ–Ω–∫–æ –î.–†.","–ö—Ä—è—à–∫–æ –Ø.–Ø.","–õ–∏—Å–∞–∫–æ–≤ –ê.–ê.","–õ—ñ–≥–∞—á–æ–≤ –Ñ.–ê.","–ú–∞—Ç–≤—ñ—î–≤–∏—á –°.–û.","–ú—ñ–∑–∏–Ω—á—É–∫ –î.–î.","–ú–æ–∫—Ä—è–∫ –ê.–°.","–ú–æ—Ç—Ä–∏—á –Ü.–Ñ.","–û–≤—á–∞—Ä–µ–Ω–∫–æ –î.–û.","–ü—ñ–≤—Ç–æ—Ä–∞—Ü—å–∫–∏–π –û.–°.","–†—É–º—è–Ω—Ü–µ–≤–∞ –ö.–û.","–°–µ–º–∏–ª—ñ—Ç –Ü.–Ñ.","–°—ñ–≤—ñ—Ä—é–∫ –Ø.–ê.","–£–¥–æ–≤—ñ–∫–æ–≤ –ù.–Ü.","–£—Å–µ–Ω–∫–æ –ú.–Æ.","–ß–µ—Ä–∫–∞—à–∏–Ω –û.–°.","–®—É–ª—è–∫ –ö.–î."] },
        "70": { name: "–ì—Ä—É–ø–∞ 70 (–Ü–¢)", startYear: 2022, students: ["–ë–µ—Ä–µ–∂–Ω–∏–π –ú.–ê.","–í–∞—â—É–∫ –ö.–ú.","–ì–µ—Ç—å–º–∞–Ω –û.–°.","–î–µ–º–µ–Ω–∫–æ –Ø.–í.","–ñ—É—Ä–∞–≤–µ–ª—å –î.–ê.","–ó–∞–ª–æ–≥—ñ–Ω –ü.–ö.","–Ü–≤–∞–Ω–æ–≤ –ì.–ê.","–ö–∏—Å–µ–ª—å –î.–Ø.","–ö–æ–≤–∞–ª–µ–Ω–∫–æ –ú.–î.","–ö—É—Ä—î–≥—è–Ω –ê.–í.","–õ–µ–±–µ–¥—î–≤ –ú.–û.","–ù–∞—Å—Ç–æ–±—É—Ä–∫–∞ –°.–Ü.","–ü–∞–≤–ª–æ–≤ –ú.–í.","–ü–æ–¥–æ—Ä–≤–∞–Ω–æ–≤ –î.–í.","–ü—Ä–∏–±–∏—Ç–æ–∫ –î.–í.","–ü—Ä—É–¥—á–µ–Ω–∫–æ –û.–î.","–†–∞–∂–¥–∞ –ú.–í.","–°–æ—à–µ–Ω–∫–æ–≤ –ú.–°.","–°—Ç—Ä–æ—á–∫–∞ –î.–†.","–°—É–Ω–¥–∞—Ä—Ü–µ–≤ –ö.–°.","–¢–∏–º–æ—â–µ–Ω–∫–æ –Ø.–†.","–¢–∫–∞—á–µ–Ω–∫–æ –î.–í.","–®–∞–ø–æ–≤–∞–ª–æ–≤ –Ü.–ï.","–©–µ—Ä–±–∏–Ω–∞ –ú.–û.","–Ø–ª–æ–≤–µ–Ω–∫–æ –ú.–û."] },
        "69": { name: "–ì—Ä—É–ø–∞ 69 (–Ü–¢)", startYear: 2022, students: ["–ë–æ–≥–¥–∞–Ω–æ–≤–∞ –ê.–î.","–ë—É–¥–∞–Ω–æ–≤ –î.–Ü.","–ì–æ–Ω—Ç–∞—Ä –î.–î.","–î–µ–Ω–∏—Å–æ–≤ –í.–†.","–î—É—Å–∏–∫ –í.–û.","–ö–∞–π—Å—Ç—Ä—è –ê.–°.","–ö–æ–≤–∞–ª–µ–Ω–∫–æ –î.–û.","–ö—Ä—è–∂ –ë.–°.","–ö—É–ª–∞–∫ –ê.–û.","–ú–∞—Ä—á–µ–Ω–∫–æ –ù.–í.","–ú–∏—Ö–∞–π–ª–µ–Ω–∫–æ –ú.–°.","–ü–µ—Ä–µ–∫–æ–ø—Å—å–∫–∏–π –í.–ú.","–ü–æ—Ç—è–≥–∞–π–ª–æ –î.–Ñ.","–°–æ–ª–æ–º–µ–Ω–∞ –Ñ.–í.","–°–æ–ª–æ–ø–æ–≤ –î.–Ñ.","–°—É—à–∫–æ –Ü.–ú.","–¢–∏–º–æ—à–µ–Ω–∫–æ –Ø.–í.","–§–æ–º–µ–Ω–∫–æ –í.–í.","–®–≤–∞–π–¥–∞–∫ –Ü.–ö.","–Ø–∫–∏–º–µ–Ω–∫–æ –¢.–í."] } },
};

const curriculumDB = {
   1: {
       "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞": "–ö–∞–ª—ñ—Å—Ç–∞ –Æ.–í.",
       "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏": "–î–æ–º–Ω—ñ–Ω–∞ –ì.–°.",
       "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞": "–°–µ—Å—å –û.–í.",
       "–ì—Ä–æ–º–∞–¥—è–Ω—Å—å–∫–∞ –æ—Å–≤—ñ—Ç–∞": "–Æ—à–∏–Ω –ü.–ë.",
       "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞": "–ö–æ–≤–∞–ª—å –Ü.–ê.",
       "–•—ñ–º—ñ—è": "–ö–æ–Ω–¥—Ä–∞—Ç–æ–≤–∞ –û.–û.",
       "–ë—ñ–æ–ª–æ–≥—ñ—è —ñ –µ–∫–æ–ª–æ–≥—ñ—è": "–ö–æ–Ω–¥—Ä–∞—Ç–æ–≤–∞ –û.–û.",
       "–§—ñ–∑–∏–∫–∞ —ñ –∞—Å—Ç—Ä–æ–Ω–æ–º—ñ—è": "–ú–∞—Ö–∏–Ω—å–∫–æ –°.–í.",
       "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞": "–§—ñ–ª—ñ–ø–ø–æ–≤ –î.–í.",
       "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": "–ñ–∏—Ç—á–µ–Ω–∫–æ –Ü.–ú.",
       "–ì–µ–æ–≥—Ä–∞—Ñ—ñ—è": "–®–µ—Ä–µ–º–µ—Ç –ù.–ú.",
       "–Ü–Ω–æ–∑–µ–º–Ω–∞ –º–æ–≤–∞": "–¢–æ–∫–∞—Ä—î–≤–∞ –û.–í."},
   2: {
       "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó": "–ì–æ–Ω—á–∞—Ä–æ–≤ –û.–ú.",
       "–Ü–Ω–æ–∑–µ–º–Ω–∞ –º–æ–≤–∞": "–¢–æ–∫–∞—Ä—î–≤–∞ –û.–í.",
       "–§—ñ–∑–∏–∫–∞ —ñ –∞—Å—Ç—Ä–æ–Ω–æ–º—ñ—è": "–ö–∞—Ä–ø–æ–≤–∞ –õ.–ú.",
       "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó (–ú2 '–ö—Ä–µ—Å–ª–µ–Ω–Ω—è')": "–í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ –Ü.–Ü.",
       "–¢–µ–æ—Ä—ñ—è –∫—ñ–ª": "–ß–æ—Ä–Ω–∏–π –û.–ê.",
       "–§—ñ–∑–∏—á–Ω–∞ –∫—É–ª—å—Ç—É—Ä–∞": "–§—ñ–ª—ñ–ø–ø–æ–≤ –î.–í.",
       "–Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": "–ñ–∏—Ç—á–µ–Ω–∫–æ –Ü.–ú.",
       "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó (–ú1 '–û—Å–Ω–æ–≤–∏')": "–ê–Ω–¥—Ä—î—î–≤ –í.–û.",
       "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞": "–ü—Ä–æ—â–µ–Ω–∫–æ –Ü.–ú.",
       "–ë—ñ–æ–ª–æ–≥—ñ—è —ñ –µ–∫–æ–ª–æ–≥—ñ—è": "–®–∞–π—Ç–∞–Ω–æ–≤–∞ –û.–ú.",
       "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ê–ª–≥–µ–±—Ä–∞": "–ö–æ–≤–∞–ª—å –Ü.–ê.",
       "–Ü—Å—Ç–æ—Ä—ñ—è –£–∫—Ä–∞—ó–Ω–∏": "–î–æ–º–Ω—ñ–Ω–∞ –ì.–°.",
       "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞": "–ü—Ä–æ—â–µ–Ω–∫–æ –Ü.–ú.",
       "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó(–ú3)": "–û–ª—ñ–π–Ω–∏–∫ –û.–Æ./–í–∞—Å–∏–ª—å—á–µ–Ω–∫–æ –Ü.–Ü.",
       "–í–∏—â–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞": "–ì–æ–Ω—á–∞—Ä–æ–≤ –û.–ú.",
       "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ –ª–æ–≥—ñ–∫–∞": "–í–æ—Ä–æ–Ω—ñ–Ω–∞ –°.–í.",
       "–û—Å–Ω–æ–≤–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤": "–ì—Ä–∞–±–æ–≤—á–∞–∫ –¢.–í."},
   3:{ "–ë–∞–∑–∏ –¥–∞–Ω–∏—Ö": "–ì–æ–Ω—á–∞—Ä–æ–≤ –û.–ú.", "–í–µ–±-–¥–∏–∑–∞–π–Ω": "–ù–µ–≤—ñ–¥–æ–º–∏–π –í.–í.", "–§—ñ–ª–æ—Å–æ—Ñ—ñ—è": "–ú—É–¥—Ä–∏–π –Ü.–Ü." },
   4:{ 
       "–ü–æ—à–∏—Ä. —Ä–∞–¥—ñ–æ—Ö–≤–∏–ª—å —Ç–∞ –ê–§–ü": "–í–∞–ª—è–≤—Å—å–∫–∏–π –í.–í.",
       "–§—ñ–∑–∏—á–Ω–µ –≤–∏—Ö–æ–≤–∞–Ω–Ω—è": "–®–∞–ø–æ—à–Ω–∏–∫–æ–≤–∞ –û.–Ü.",
       "–Ü–Ω–æ–∑–µ–º–Ω–∞ –º–æ–≤–∞": "–¢–æ–∫–∞—Ä—î–≤–∞ –û.–í. / –ì—Ä–µ–±–µ–Ω—é–∫ –ê.–ê.",
       "–ï–ª. –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è": "–ú–µ–¥–≤–µ–¥—î–≤–∞ –õ.–°.",
       "–¶–∏—Ñ—Ä–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞": "–ß–æ—Ä–Ω–∏–π –û.–ê.",
       "–ü—Ä–∏—Å—Ç—Ä–æ—ó –ø—Ä–∏–π. —Ç–∞ –ø–µ—Ä–µ–¥–∞—á—ñ": "–ú–µ–¥–≤–µ–¥—î–≤–∞ –õ.–°.",
       "–ö–æ–Ω—Å—Ç—Ä—É—é–≤–∞–Ω–Ω—è —ñ —Ç–µ—Ö.": "–ö–æ–Ω–¥—Ä–∞—Ç–æ–≤ –û.–í.",
       "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞": "–ñ–∏—Ç—á–µ–Ω–∫–æ –Ü.–ú./–ì—Ä–∞–±–æ–≤—á–∞–∫ –¢.–í."},
};

const reasons = ["","–Ω–µ–º.—Å–≤—ñ—Ç–ª","–Ω–µ–º.—ñ–Ω—Ç.","–∑–∞—Ö–≤–æ—Ä—ñ–≤","—Å—ñ–º. –æ–±—Å—Ç.","–±–µ–∑ –ø–æ–≤.–ø—Ä–∏—á.","—ñ–Ω–¥.","—Ö–≤–æ—Ä—ñ—î","—É –ª—ñ–∫–∞—Ä—è","–Ω–∞ –∫–æ–Ω–∫—É—Ä—Å—ñ","—Ç–µ—Ö–Ω. –ø—Ä–æ–±–ª."];
const monthNames = ["–°—ñ—á–Ω—è", "–õ—é—Ç–æ–≥–æ", "–ë–µ—Ä–µ–∑–Ω—è", "–ö–≤—ñ—Ç–Ω—è", "–¢—Ä–∞–≤–Ω—è", "–ß–µ—Ä–≤–Ω—è", "–õ–∏–ø–Ω—è", "–°–µ—Ä–ø–Ω—è", "–í–µ—Ä–µ—Å–Ω—è", "–ñ–æ–≤—Ç–Ω—è", "–õ–∏—Å—Ç–æ–ø–∞–¥–∞", "–ì—Ä—É–¥–Ω—è"];

let currentDept = null;
let currentGroup = null;
let currentCourse = 1;
let currentTeachers = {};
let uploadedWorkbookBuffer = null;
let rowTeacherOptions = {}; // –î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –≤—á–∏—Ç–µ–ª—ñ–≤

// === LOGIC ===

function selectDept(dept, btn) {
    currentDept = dept;
    document.querySelectorAll('.dept-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const select = document.getElementById('groupSelect');
    select.innerHTML = '<option value="" disabled selected>‚Äî –û–±–µ—Ä—ñ—Ç—å –≥—Ä—É–ø—É ‚Äî</option>';
    
    if (groupsDB[dept]) {
        Object.keys(groupsDB[dept]).forEach(id => {
            const opt = document.createElement('option');
            opt.value = id; opt.innerText = groupsDB[dept][id].name;
            select.appendChild(opt);
        });
        document.getElementById('groupAnimWrapper').classList.add('open');
        document.getElementById('btnAnimWrapper').classList.remove('visible');
    }
}

function checkGroup() {
    const val = document.getElementById('groupSelect').value;
    if(val) document.getElementById('btnAnimWrapper').classList.add('visible');
}

function calculateCourse(startYear) {
    const today = new Date();
    const academicYearStart = (today.getMonth() < 8) ? today.getFullYear() - 1 : today.getFullYear();
    return Math.max(1, Math.min(4, (academicYearStart - startYear) + 1));
}

function enterApp() {
    const groupKey = document.getElementById('groupSelect').value;
    if(!groupKey) return;
    
    currentGroup = groupsDB[currentDept][groupKey];
    currentCourse = calculateCourse(currentGroup.startYear);
    currentTeachers = curriculumDB[currentCourse] || {};
    
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('appScreen').classList.remove('hidden');
    document.getElementById('headerTitle').innerText = currentGroup.name;
    document.getElementById('headerSubtitle').innerText = `${currentCourse} –∫—É—Ä—Å ‚Ä¢ ${Object.keys(currentTeachers).length} –ø—Ä–µ–¥–º–µ—Ç—ñ–≤`;

    // Init Date
    const d = new Date();
    document.getElementById('dayInput').value = d.getDate();
    document.getElementById('monthInput').value = d.getMonth();
    document.getElementById('yearInput').value = d.getFullYear();
    
    renderSchedule();
    renderStudents();
}

function renderSchedule() {
    const container = document.getElementById('scheduleContainer');
    container.innerHTML = '';
    for (let i = 0; i <= 4; i++) {
        container.innerHTML += `
            <div class="schedule-item">
                <span class="item-label">${i} –ü–ê–†–ê</span>
                <div style="display:flex; gap:10px; align-items:center;">
                    <select id="subj_${i}" class="pixel-select" onchange="autoTeacher(${i})">
                        <option value="">‚Äî –ü—Ä–µ–¥–º–µ—Ç ‚Äî</option>
                        ${Object.keys(currentTeachers).map(s => `<option value="${s}">${s}</option>`).join("")}
                        <option value="custom">–Ü–Ω—à–µ...</option>
                    </select>
                    
                    <div class="input-wrapper">
                        <input id="teach_${i}" class="pixel-input" placeholder="–í–∏–∫–ª–∞–¥–∞—á" style="padding-right: 40px;">
                        <button id="swap_btn_${i}" onclick="cycleTeacher(${i})" class="input-icon-btn hidden" title="–ó–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–ª–∞–¥–∞—á–∞">
                            <span class="material-icons-round" style="font-size: 18px;">swap_horiz</span>
                        </button>
                    </div>
                </div>
            </div>`;
    }
}

function autoTeacher(i) {
    const subjVal = document.getElementById(`subj_${i}`).value;
    const teachEl = document.getElementById(`teach_${i}`);
    const swapBtn = document.getElementById(`swap_btn_${i}`);
    
    // –°–∫–∏–¥–∞—î–º–æ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ–ø—Ü—ñ—ó
    rowTeacherOptions[i] = [];

    if (currentTeachers[subjVal]) {
        const rawTeachers = currentTeachers[subjVal];
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —î —Å–ª–µ—à —É –Ω–∞–∑–≤—ñ (–∫—ñ–ª—å–∫–∞ –≤—á–∏—Ç–µ–ª—ñ–≤)
        if (rawTeachers.includes('/')) {
            const options = rawTeachers.split('/').map(t => t.trim());
            rowTeacherOptions[i] = options;
            
            teachEl.value = options[0]; // –°—Ç–∞–≤–∏–º–æ –ø–µ—Ä—à–æ–≥–æ
            swapBtn.classList.remove('hidden'); // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É
            showToast(`–ó–Ω–∞–π–¥–µ–Ω–æ ${options.length} –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤. –¢–∏—Å–Ω—ñ—Ç—å —Å—Ç—Ä—ñ–ª–∫–∏ –¥–ª—è –∑–º—ñ–Ω–∏.`);
        } else {
            teachEl.value = rawTeachers;
            swapBtn.classList.add('hidden');
        }

        // Auto-check students logic
        currentGroup.students.forEach((_, idx) => {
            const checkbox = document.querySelector(`.p${idx}[value="${i}"]`);
            if(checkbox) checkbox.checked = true;
        });
        
    } else if (subjVal !== "custom") {
        teachEl.value = "";
        swapBtn.classList.add('hidden');
    } else {
        swapBtn.classList.add('hidden');
    }
}

function cycleTeacher(i) {
    const currentVal = document.getElementById(`teach_${i}`).value;
    const options = rowTeacherOptions[i];
    
    if (options && options.length > 1) {
        let idx = options.indexOf(currentVal);
        // –Ø–∫—â–æ –ø–æ—Ç–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–º—ñ–Ω–∏–≤ –≤—Ä—É—á–Ω—É), –ø–æ—á–∏–Ω–∞—î–º–æ –∑ 0
        if (idx === -1) idx = -1;
        
        const nextIdx = (idx + 1) % options.length;
        document.getElementById(`teach_${i}`).value = options[nextIdx];
    }
}

function renderStudents() {
    const container = document.getElementById('studentsContainer');
    container.innerHTML = '';
    currentGroup.students.forEach((s, i) => {
        container.innerHTML += `
            <div class="student-item">
                <span class="student-name">${s}</span>
                <label class="switch">
                    <input type="checkbox" id="chk_${i}" onchange="toggleDetails(${i})">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="student-details" id="det_${i}">
                <div class="details-content">
                    <select id="reason_${i}" class="pixel-select" style="margin-bottom:10px; height:44px;">
                        ${reasons.map(r => `<option>${r}</option>`).join("")}
                    </select>
                    <div class="chips">
                        ${[0,1,2,3,4].map(p => `
                            <label class="chip-lbl">
                                <input type="checkbox" class="p${i}" value="${p}" style="display:none">
                                <div class="chip-div">${p}</div>
                            </label>`).join('')}
                    </div>
                </div>
            </div>`;
    });
}

function toggleDetails(i) {
    const el = document.getElementById(`det_${i}`);
    const isChecked = document.getElementById(`chk_${i}`).checked;
    el.style.height = isChecked ? (el.scrollHeight + "px") : "0px";
}

function toggleTheme() {
    document.body.classList.toggle('light-mode');
}

function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.innerText = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
}

// === EXCEL LOGIC ===

// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
function handleFileUpload(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        uploadedWorkbookBuffer = e.target.result;
        
        // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        document.getElementById('uploadBtn').classList.add('active');
        document.getElementById('uploadBtnText').innerText = "–§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ! (–°–∫–∏–Ω—É—Ç–∏)";
        document.getElementById('uploadBtn').setAttribute('onclick', 'resetFile()');
        document.getElementById('fileStatus').innerHTML = `–§–∞–π–ª: ${file.name}<br>–†–µ–∂–∏–º: <b style="color:var(--accent)">–î–æ–ø–æ–≤–Ω–µ–Ω–Ω—è (–ü—Ä–∞–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞)</b>`;
        
        showToast("üìÇ –§–∞–π–ª –ø—Ä–∏–π–Ω—è—Ç–æ! –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø—Ä–∞–≤—É —Å—Ç–æ—Ä–æ–Ω—É.");
    };
    reader.readAsArrayBuffer(file);
}

function resetFile() {
    uploadedWorkbookBuffer = null;
    document.getElementById('fileUpload').value = "";
    
    document.getElementById('uploadBtn').classList.remove('active');
    document.getElementById('uploadBtnText').innerText = "–ú–∞—é —Ñ–∞–π–ª (–ó–∞–ø–æ–≤–Ω–∏—Ç–∏ –ü—Ä–∞–≤—É)";
    document.getElementById('uploadBtn').setAttribute('onclick', "document.getElementById('fileUpload').click()");
    document.getElementById('fileStatus').innerHTML = "–†–µ–∂–∏–º: <b>–ù–æ–≤–∏–π —Ñ–∞–π–ª (–õ—ñ–≤–∞ —Å—Ç–æ—Ä–æ–Ω–∞)</b>";
    
    showToast("‚Ü∫ –†–µ–∂–∏–º —Å–∫–∏–Ω—É—Ç–æ –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É.");
}

function base64ToArrayBuffer(base64) {
    const binaryString = window.atob(base64.replace(/\s/g, ''));
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) { bytes[i] = binaryString.charCodeAt(i); }
    return bytes.buffer;
}

function setCellStyle(cell, isBold) {
    cell.font = { name: "Times New Roman", size: 11, bold: isBold };
}

async function generateExcel() {
  if (!uploadedWorkbookBuffer && !templateBase64) { 
      showToast("‚ùå –ü–æ–º–∏–ª–∫–∞: –ù–µ–º–∞—î —à–∞–±–ª–æ–Ω—É!"); return; 
  }
  
  showToast("‚è≥ –û–±—Ä–æ–±–∫–∞ –¥–∞–Ω–∏—Ö...");

  try {
      // –õ–û–ì–Ü–ö–ê –í–ò–ë–û–†–£ –°–¢–û–†–û–ù–ò
      const isExistingFile = !!uploadedWorkbookBuffer;
      const side = isExistingFile ? 'right' : 'left';
      
      const cols = {
          header:   side === 'left' ? "A2" : "K2",
          subject:  side === 'left' ? "B"  : "L",
          teacher:  side === 'left' ? "C"  : "M",
          grades:   side === 'left' ? ["C","D","E","F","G"] : ["M","N","O","P","Q"], 
          total:    side === 'left' ? "H"  : "R"
      };

      const wb = new ExcelJS.Workbook();
      
      let buffer;
      if (isExistingFile) {
          buffer = uploadedWorkbookBuffer;
      } else {
          buffer = base64ToArrayBuffer(templateBase64);
      }
      
      await wb.xlsx.load(buffer);
      const ws = wb.getWorksheet(1);
      
      const day = document.getElementById('dayInput').value;
      const monthIdx = document.getElementById('monthInput').value;
      const yearFull = document.getElementById('yearInput').value;
      const groupNameOnly = currentGroup.name.replace(/\D/g,''); 
      const monthStr = monthNames[monthIdx];
      const yearPrefix = yearFull.toString().substring(0, 2); 
      const yearSuffix = yearFull.toString().substring(2, 4);

      const fontBase = { name: 'Times New Roman', size: 10 };
      const fontUnder = { name: 'Times New Roman', size: 10, underline: true };
      const fontBoldItalic = { name: 'Times New Roman', size: 10, bold: true, italic: true };
      const fontBoldItalicUnder = { name: 'Times New Roman', size: 10, bold: true, italic: true, underline: true };

      // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —à–∞–ø–∫—É
      ws.getCell(cols.header).value = {
        richText: [
          { text: '"', font: fontBase }, { text: '  ' + day + '  ', font: fontUnder }, 
          { text: '"   ', font: fontBase }, { text: '   ' + monthStr, font: fontUnder }, 
          { text: ' ', font: fontBase }, { text: yearPrefix, font: fontBoldItalic },
          { text: yearSuffix, font: fontBoldItalicUnder }, { text: ' —Ä.  –ì—Ä. ‚Ññ', font: fontBase }, 
          { text: '  ' + groupNameOnly + '  ', font: fontUnder }, { text: '.', font: fontBase }
        ]
      };

      // === –ó–ê–ü–û–í–ù–ï–ù–ù–Ø –ü–†–ï–î–ú–ï–¢–Ü–í ===
      const rowMap = {0:4, 1:5, 2:6, 3:7, 4:8}; 
      for (let i = 0; i <= 4; i++) {
        const subjVal = document.getElementById(`subj_${i}`).value;
        const teachVal = document.getElementById(`teach_${i}`).value;
        
        if (subjVal || teachVal) {
            ws.getCell(`${cols.subject}${rowMap[i]}`).value = subjVal;
            ws.getCell(`${cols.teacher}${rowMap[i]}`).value = teachVal;
        }
      }

      // === –ó–ê–ü–û–í–ù–ï–ù–ù–Ø –°–¢–£–î–ï–ù–¢–Ü–í (–û–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞) ===
      let row = 11; 
      currentGroup.students.forEach((s, i) => {
        if(document.getElementById(`chk_${i}`).checked){
          const reason = document.getElementById(`reason_${i}`).value;
          
          // –Ü–º'—è + –ü—Ä–∏—á–∏–Ω–∞ (–ë–µ–∑ —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è)
          const nameCell = ws.getCell(`${cols.subject}${row}`);
          
          if (reason && reason !== "") {
              nameCell.value = `${s} (${reason})`;
          } else {
              nameCell.value = s;
          }

          setCellStyle(nameCell, false);

          // –û—Ü—ñ–Ω–∫–∏ (–ó —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è–º)
          let hours = 0;
          document.querySelectorAll(`.p${i}:checked`).forEach(p => {
            const colLetter = cols.grades[p.value];
            if (colLetter) {
                const gradeCell = ws.getCell(`${colLetter}${row}`);
                gradeCell.value = "2";
                setCellStyle(gradeCell, true);
                gradeCell.alignment = { horizontal: "center", vertical: "middle" };
                hours += 2;
            }
          });

          // –°—É–º–∞ (–ó —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è–º)
          const totalCell = ws.getCell(`${cols.total}${row}`);
          totalCell.value = hours;
          setCellStyle(totalCell, true);
          totalCell.alignment = { horizontal: "center", vertical: "middle" };
          
          row++;
        }
      });

      const outBuf = await wb.xlsx.writeBuffer();
      
      let fileName = `raport_${groupNameOnly}_${day}_${monthStr}`;
      if (side === 'right') fileName += "_Completed"; 
      else fileName += "_Left";
      
      saveAs(new Blob([outBuf]), fileName + ".xlsx");
      showToast("‚úÖ –§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!");
      
      if (side === 'right') resetFile();

  } catch (e) {
      console.error(e);
      alert("–ü–æ–º–∏–ª–∫–∞: " + e.message);
  }
}

function sendToDept() {
    if(!currentDept) { showToast("‚ö†Ô∏è –°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è!"); return; }
    
    const email = deptEmails[currentDept];
    const subject = `–†–∞–ø–æ—Ä—Ç–∏—á–∫–∞: ${currentGroup.name}`;
    const body = `–î–æ–±—Ä–æ–≥–æ –¥–Ω—è!\n\n–ù–∞–¥—Å–∏–ª–∞—é —Ä–∞–ø–æ—Ä—Ç–∏—á–∫—É –≥—Ä—É–ø–∏ ${currentGroup.name} –∑–∞ ${document.getElementById('dayInput').value}-–µ —á–∏—Å–ª–æ.\n(–§–∞–π–ª —Ä–∞–ø–æ—Ä—Ç–∏—á–∫–∏ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–æ –¥–æ —Ü—å–æ–≥–æ –ª–∏—Å—Ç–∞).`;
    
    window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    showToast(`üìß –í—ñ–¥–∫—Ä–∏–≤–∞—é –ø–æ—à—Ç—É –¥–ª—è ${currentDept}...`);
}
</script>
</body>
</html>
